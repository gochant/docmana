<!DOCTYPE html>
<html lang="en">
<head>
    <title>Docmana</title>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <link href="assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link id="theme-style" href="assets/bootstrap/themes/default.css" rel="stylesheet" />
    <!--<link href="../dist/css/docmana.css" rel="stylesheet" />-->
    <link href="../src/less/docmana.css" rel="stylesheet" />
    <style>
        body {
            padding: 20px 0;
            font-family: Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
        }

        .navbar-form .form-group {
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="#">
                        Docmana
                    </a>
                </div>
                <form class="navbar-form navbar-right form-inline">
                    <div class="form-group">
                        <label class="control-label txt-lang">language: </label>
                        <select class="form-control" id="select-lang">
                            <option value="en">en</option>
                            <option value="zh-CN">zh-CN</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="control-label txt-theme">theme: </label>
                        <select class="form-control" id="select-theme"></select>
                    </div>
                </form>
            </div>
        </nav>
        <div style="height: 500px">
            <div id="docmana"></div>
        </div>
    </div>

    <script src="assets/jquery.min.js"></script>
    <script src="assets/lodash.min.js"></script>
    <script src="assets/bootstrap.min.js"></script>
    <script src="assets/backbone.min.js"></script>
    <script src="../src/js/vendor/date.format.js"></script>
    <script src="../src/js/vendor/jquery-ui.js"></script>
    <script src="../src/js/vendor/jquery.autosize.input.js"></script>
    <script src="../src/js/vendor/jquery.fileDownload.js"></script>
    <script src="../src/js/vendor/jquery.form.js"></script>
    <script src="../src/js/vendor/jquery.hotkeys.js"></script>
    <script src="../src/js/vendor/pdfobject.js"></script>
    <script src="assets/jquery.iframe-transport.js"></script>
    <script src="assets/jquery.fileupload.js"></script>

    <script src="../src/js/docmana.js"></script>
    <script src="../src/js/templates.js"></script>
    <script src="../src/js/kernel/core.js"></script>
    <script src="../src/js/kernel/utils.js"></script>
    <script src="../src/js/kernel/templateHelper.js"></script>
    <script src="../src/js/kernel/app.js"></script>
    <script src="../src/js/kernel/clipboard.js"></script>

    <script src="../src/js/kernel/history.js"></script>
    <script src="../src/js/kernel/mime.js"></script>
    <script src="../src/js/kernel/plugins.js"></script>
    <script src="../src/js/kernel/resource.js"></script>
    <script src="../src/js/kernel/store.js"></script>
    <script src="../src/js/kernel/template.js"></script>
    <script src="../src/js/commands/back.js"></script>
    <script src="../src/js/commands/copy.js"></script>
    <script src="../src/js/commands/cut.js"></script>
    <script src="../src/js/commands/download.js"></script>
    <script src="../src/js/commands/duplicate.js"></script>
    <script src="../src/js/commands/forward.js"></script>
    <script src="../src/js/commands/layout.js"></script>
    <script src="../src/js/commands/mkdir.js"></script>
    <script src="../src/js/commands/mkfile.js"></script>
    <script src="../src/js/commands/open.js"></script>
    <script src="../src/js/commands/paste.js"></script>
    <script src="../src/js/commands/refresh.js"></script>
    <script src="../src/js/commands/rename.js"></script>
    <script src="../src/js/commands/rm.js"></script>
    <script src="../src/js/commands/search.js"></script>
    <script src="../src/js/commands/sort.js"></script>
    <script src="../src/js/commands/upload.js"></script>
    <script src="../src/js/ui/breadcrumbs.js"></script>
    <script src="../src/js/ui/navigation.js"></script>
    <script src="../src/js/ui/notify.js"></script>
    <script src="../src/js/ui/statusbar.js"></script>
    <script src="../src/js/ui/templates.js"></script>
    <script src="../src/js/ui/toolbar.js"></script>
    <script src="../src/js/ui/uploader.js"></script>
    <script src="../src/js/ui/viewer.js"></script>
    <script src="../src/js/ui/workzone.js"></script>
    <script src="../src/js/i18n/en.js"></script>
    <script src="../src/js/i18n/zh-CN.js"></script>
    <script>
        $(function () {



            function setLocal(key, value) {
                if (window.localStorage) {
                    localStorage.setItem(key, value);
                }
            }

            function getLocal(key) {
                if (window.localStorage) {
                    return localStorage.getItem(key);
                }
                return null;
            }

            var initData = {
                lang: getLocal('lang') || 'en',
                theme: getLocal('theme') || 0
            }



            docmana.lang = initData.lang;

            // 这里仅针对这个示例界面简单处理
            $('.txt-lang').text(docmana.resource('labelLanguage'));
            $('.txt-theme').text(docmana.resource('labelTheme'));

            var themes = ['default', 'cerulean', 'cosmo', 'darkly', 'flatly', 'lumen', 'paper',
                'sandstone', 'simplex', 'spacelab', 'superhero', 'tiny'];
            var $select = $("#select-theme");
            var $selectLang = $('#select-lang');

            $.each(themes, function (index, value) {
                $select.append($("<option />")
                    .val(index)
                    .text(value));
            });

            $selectLang.on('change', function () {
                var val = $(this).val();
                setLocal('lang', val);
                window.location.reload();
            }).val(initData.lang);

            $select.on('change', function () {
                var val = $(this).val();
                var theme = themes[val];
                var css = 'assets/bootstrap/themes/' + theme + '.css';
                setLocal('theme', val);
                $("#theme-style").attr("href", css);
                setTimeout(function () {
                    $('#docmana').data('docmana').relayout();
                }, 500);
            }).val(initData.theme).change();


            $('#docmana').docmana({
                store: {
                    requestData: {
                        folder: 'Medias',
                        lang: docmana.lang
                    },
                    url: 'http://192.168.1.18:8097/FileManager/Medias/Index'
                },
                workzone: {
                    layout: 'icons'
                }
            });
        });
    </script>
</body>
</html>